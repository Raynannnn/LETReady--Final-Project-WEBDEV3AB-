<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Log In</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="circle half-left" id="circle"></div>

<div class="auth-box" style="right:8%;">
  <h2>LOG IN</h2>
  <input type="text" id="name" placeholder="Name">
  <input type="password" id="pass" placeholder="Password">
 <button onclick="login()">Submit</button>
</div>

<div class="overlay" id="overlay"></div>

<script src="database.js"></script>
<script src="script.js"></script>
<script>
let c = document.getElementById("circle");
let start = 0;
let drag = false;

c.addEventListener("mousedown", (e)=>{
  start = e.clientX;
  drag = true;
  c.style.transition="transform 0.2s ease, opacity 0.3s ease";
});

document.addEventListener("mousemove", (e)=>{
  if(!drag) return;
  let d = e.clientX - start;
  c.style.transform=`translate(${d}px, -50%) scale(${1 + Math.abs(d)/700})`;
  c.style.opacity = 1 - Math.abs(d)/420;
});

document.addEventListener("mouseup", ()=>{
  if(!drag) return;
  drag = false;
  c.classList.add("expand");
  let o = document.getElementById("overlay");
  if(o) o.classList.remove("active");
  setTimeout(()=> window.location.href="index.html", 350);
});
</script>

<script>
function login(){
  let name = document.getElementById("name").value;
  let pass = document.getElementById("pass").value;

  let users = getUsers();
  let user = users.find(u => u.name === name && u.password === pass);

  if(!user){
    alert("Invalid login");
    return;
  }

  if(user.role === "admin" && user.status !== "approved"){
    alert("Admin not approved yet");
    return;
  }

  // Store the full user object in localStorage
  localStorage.setItem("currentUser", JSON.stringify(user));

  // Redirect based on role
  if(user.role === "admin"){
    window.location.href = "main-adminsite/main-adminsite.html";
  } else {
    window.location.href = "main-usersite.html";
  }
}


</script>

</body>
</html>
